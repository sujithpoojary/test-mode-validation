pipeline {
    agent any

    stages {
        stage('Unit Tests') {
            steps {
                // Your code to run unit tests
                echo 'Running unit tests...'
            }
        }
        stage('Integration Tests') {
            steps {
                // Your code to run integration tests
                echo 'Running integration tests...'
            }
        }
        stage('Functional Tests') {
            steps {
                // Your code to run functional tests
                echo 'Running functional tests...'
            }
        }
        stage('Performance Tests') {
            steps {
                // Your code to run performance tests
                echo 'Running performance tests...'
            }
        }
        stage('Validation Stage') {
            steps {
                script {
                    // Your code to run Validation Stage
                    echo 'Running Validation Stage to verify Stage Data..'
                    def validationURL = "${BUILD_URL}wfapi/describe"
                    echo "Validation URL : "+ validationURL
                    //sh "curl"
                    //sh "curl -X GET -H \"Content-Type:application/json\" ${validationURL}"
                    //def response = sh(script: "curl -s ${validationURL}", returnStdout: true).trim()
                    def response = bat(script: "start /B curl -s ${validationURL}", returnStdout: true).trim()
                    writeFile file: 'validation_stage_data.json', text: response
                    echo 'Build data saved to validation_stage_data.json'
                    echo response
                }   
            }   
        }
    }
    post {
        success {
            echo 'All tests passed! Deploying...'
            // Your code to deploy the application
        }
        failure {
            echo 'Tests failed! Notify the team and do not deploy.'
            // Your code to notify the team about test failures
        }
    }
}
